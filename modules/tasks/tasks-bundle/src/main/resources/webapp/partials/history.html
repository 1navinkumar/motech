<!------------------------  History ------------------------------------->
<div class="row-fluid" xmlns="http://www.w3.org/1999/html">
    <div class="margin-after history">
        <div class="box-header">{{msg('header.taskHistory')}} <a href="#/task/" type="button" class="btn btn-primary btn-in-header pull-right"><i class="icon-mail-reply icon-white"></i></a></div>
        <div class="box-content tasks-list">
            <div class="inbox-header" ng-class="{true:'', false:'paused'}[enabled]">
                <div class="task-bar">
                    <ul class="task-nav">
                        <li class="task-element"><img ng-src="../tasks/api/channel/icon?moduleName={{trigger.module}}" class="task-list-img" /></li>
                        <li class="task-element"><img src="../tasks/img/arrow.png" class="task-list-img-arrow"/></li>
                        <li class="task-element"><img ng-src="../tasks/api/channel/icon?moduleName={{action.module}}" class="task-list-img" /></li>
                        <li class="divider-vertical"></li>
                        <li class="task-element task-name">
                            <span class="name-first">{{name}}</span>
                            <span class="name-second-history">{{msg('section.recentActivityForTask')}}&nbsp;<i class="icon-caret-right"></i>&nbsp;{{msg(trigger.display)}} - {{msg(action.display)}}</span>
                        </li>
                    </ul>

                    <ul class="task-nav pull-right">
                        <li ng-show="description && enabled" class="task-element" bs-popover data-trigger="hover" data-content="{{description}}" data-placement="left"><img src="../tasks/img/task-info.png"  class="task-list-img" /></li>
                        <li ng-show="description && !enabled" class="task-element" bs-popover data-trigger="hover" data-content="{{description}}" data-placement="left"><img src="../tasks/img/task-info-paused.png"  class="task-list-img" /></li>
                        <li ng-show="description" class="divider-vertical"></li>
                        <li ng-hide="enabled" class="task-element task-paused">
                            <div class="task-list-button-activity">
                                <div class="task-list-text-activity">{{msg('task.paused')}}</div>
                                <div class="task-list-div-activity"><img class="task-list-img-activity" src="../tasks/img/task-paused.png" /></div>
                            </div>
                        </li>
                        <li ng-show="enabled" class="task-element task-active">
                            <div class="task-list-button-activity">
                                <div class="task-list-div-activity"><img class="task-list-img-activity" src="../tasks/img/task-active.png" /></div>
                                <div class="task-list-text-activity">{{msg('task.active')}}</div>
                            </div>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
            </div>
            <div class="clearfix"></div><div class="margin-before2"></div>

            <div class="margin-after"  ng-show="activities.length &gt; 0">
                <div class="control-group form-inline">
                    <label class="interval">{{msg('header.filterActivity')}}</label>
                    <select ng-model="filterHistory" ng-change="changeFilterHistory()" ng-options="history for history in histories"></select>
                    <label class="interval">{{msg('header.activitiesPerPage')}}</label>
                    <select class="span1" ng-model="itemsPerPage" ng-change="changeItemsPerPage()" ng-options="itemsPerPage for itemsPerPage in limitPages"></select>
                    <a href ng-click="clearHistory()" class="btn btn-danger"> {{msg('button.clearHistory')}}</a>
                </div>
                <div class="box-content clearfix" ng-hide="activities.length == 0">
                    <table class="table table-striped table-lightblue table-bordered table-recent-activity-task table-condensed">
                        <thead>
                        <tr>
                            <th>{{msg('subsection.status')}}</th>
                            <th>{{msg('subsection.message')}}</th>
                            <th>{{msg('subsection.information')}}</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="activity in pagedItems[currentPage]">
                            <td>
                                <img ng-show="activity.activityType == 'SUCCESS'" src="../tasks/img/icon-ok.png" class="recent-activity-task-img"/>
                                <img ng-show="activity.activityType == 'ERROR'" src="../tasks/img/icon-exclamation.png" class="recent-activity-task-img"/>
                                <img ng-show="activity.activityType == 'WARNING'" src="../tasks/img/icon-question.png" class="recent-activity-task-img"/>
                            </td>
                            <td class="message-history">
                                <p class="wrap-paragraph" ng-hide="activity.stackTraceElement.length &gt; 1">{{msg(activity.message, activity.fields)}}</p>
                                <p class="wrap-paragraph" ng-show="activity.stackTraceElement.length &gt; 1">{{msg(activity.message, activity.fields)}}
                                    <span class="label label-important pointer" data-toggle="collapse" data-target="#stackHistory{{$index}}">
                                        {{msg('button.showStackTrace')}}
                                    </span>
                                </p>
                                <pre id="stackHistory{{$index}}" class="collapse" ng-show="activity.stackTraceElement.length &gt; 1">{{activity.stackTraceElement}}</pre>
                            </td>
                            <td>{{ activity.date | fromNow }}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="pagination pagination-centered pagination-condensed lightblue" ng-show="pagedItems.length &gt; 1">
                    <ul>
                        <li ng-class="{disabled: currentPage == 0}"><a href ng-click="firstPage()">{{msg('pagination.first')}}</a></li>
                        <li ng-class="{disabled: currentPage == 0}"><a href ng-click="prevPage()">{{msg('pagination.prev')}}</a></li>
                        <li ng-repeat="number in range(pagedItems.length)"
                            ng-hide="hidePages(number)"
                            ng-class="{active: number == currentPage}"
                            ng-click="setPage()">
                            <a href ng-bind="number + 1">1</a>
                        </li>
                        <li ng-class="{disabled: currentPage == pagedItems.length - 1}"><a href ng-click="nextPage()">{{msg('pagination.next')}}</a></li>
                        <li ng-class="{disabled: currentPage == pagedItems.length - 1}"><a href ng-click="lastPage(pagedItems.length - 1)">{{msg('pagination.last')}}</a></li>
                    </ul>
                </div>
                <div class="alert" ng-show="activities.length == 0">
                    <strong>{{msg('warning')}}:</strong>
                    {{msg('info.notFoundActivities')}}
                </div>
            </div>
            <div class="inside">
                <a href ng-click="clearHistory()" class="btn btn-danger"> {{msg('button.clearHistory')}}</a>
                <a href="#/task/" class="btn btn-primary"> {{msg('button.back')}}</a>
            </div>
        </div>
    </div>
</div>
